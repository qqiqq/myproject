设置字符串键值
set foo bar

查询字符串
get foo

设置多个字符串键值
mset a 1 b 2 c 3 d 4

查询多个字符串
mget a b c d

设置字符串时，对应键不存在，否则设置失败，
setnx hello world
可用于分布式事务锁：https://redis.io/topics/distlock


计数
incr counter

自增还有以下函数
decr key 自减
incrby key increment 自增指定值
decrby key decrement 自减指定值
incrbyfloat key increment 自增指定浮点值

键值后追加
APPEND hello ' and beijing'

键值字符串长度
STRLEN hello

设置字符串键值，并返回被覆盖的原值
getset hello world

设置字符串键值，从指定位置（0）开始，替换成指定值（lol）
SETRANGE hello 0 lol

从指定位置范围内获取字符串键值
GETRANGE hello 1 3

hash结构
适用于存储关系型数据
设置哈希值，user:1键的name域（field）的值为tom
hset user:1 name tom

查询哈希值，user:1键的name域的值
hget user:1 name

删除哈希
HDEL user:1 age

计算哈希下的field数量
HLEN user:1

查询哈希下多个field的值
hmget user:1 name age

设置哈希下多个field的值
hmset user:2 name mike age 12 city tianjin

查询指定键下所有field名字
hkeys user:2

查询指定键下所有field的值
hvals user:2

查询指定键下所有field-value对
HGETALL user:2

判断指定field是否存在
HEXISTS user:2 name

指定键的field的值递增指定值
HINCRBY user:2 age 1

指定键的field的值字节长度
HSTRLEN user:2 name


list操作
从右端向list中插入数据
rpush listkey c b a
从左端插入
lpush listkey c b a

从左端根据指定范围查询list，-1为最后一个index
lrange listkey 0 -1

在元素a前插入元素x
LINSERT listkey before a x
在元素4后插入元素10
linsert listkey after 4 10

查询指定位置的元素值
lindex listkey -1

查看list的长度（元素数量）
llen listkey

从list左端弹出数据
lpop listkey
从右端弹出
rpop listkey

从左端开始，删除3个元素a
LREM listkey 3 a
从右端开始，删除2个元素a
LREM listkey -2 a
删除所有元素5
lrem listkey 0 5

保留指定范围的数据
LTRIM listkey 0 -3

修改指定元素的值
lset listkey 3 xxx

从指定的list中pop元素，可以设置timeout（0）
brpop list1 list 2 list3 0
timeout为0时一直等待队列中填充数据（若队列为空）
一旦指定队列中有数据，将会在第一个发起brpop的会话中反馈元素

以下是适用list的应用场景
lpush+lpop=Stack（栈）
lpush+rpop=Queue（队列）
lpsh+ltrim=Capped Collection（有限集合）
lpush+brpop=Message Queue（消息队列）


集合操作：
添加集合元素
sadd myset a b c

删除元素
srem myset a b

计算集合内元素数量（时间复杂度为O（1））
scard myset

集合内是否存在元素c
SISMEMBER myset c

随机返回指定数量的集合内元素，不指定数量，默认为1
SRANDMEMBER myset 3

随机弹出指定数量的集合内元素，不指定数量，默认为1
spop myset 2

遍历集合内元素
SMEMBERS myset

集合间操作
注意：redis集群版对多key命令的支持，只能支持多key都在同一个slot上，即使多个slot在同一个节点上也不行

多个集合的交集
sinter user:1:follow user:2:follow

多个集合的并集
sunion user:1:follow user:2:follow

多个集合的差集
sdiff user:1:follow user:2:follow

将多个集合的计算结果存入user:1_2:inter集合中
sinterstore/suionstore/sdiffstore user:1_2:inter user:1:follow user:2:follow

以下是适用集合的应用场景
sadd=Tagging（标签）
spop/srandmember=Random item（生成随机数，比如抽奖）
sadd+sinter=Social Graph（社交需求）


有序集合
添加成员，时间复杂度为O（log（n））
zadd user:ranking 1 kris 91 mike 200 frank 220 tim 250 martin

计算成员个数
zcard user:ranking

查询某个成员的分数，如果成员不存在则返回nil
ZSCORE user:ranking mike

计算成员排名
从高到低排（从0开始）
zrevrank user:ranking mike
从低到高排（从0开始）
zrank user:ranking tim

删除成员
ZREM user:ranking tim

增加成员分数
ZINCRBY user:ranking 9 kris

返回指定范围的成员，并返回分数（可选）
从高到低排（从0开始）
ZREVRANGE user:ranking 2 4 withscores
从低到高排（从0开始）
zrange user:ranking 0 3 withscores
返回所有成员
zrange user:ranking 0 -1 withscores

返回指定分数的成员，并返回分数（可选）
ZRANGEBYSCORE user:ranking 50 220 withscores
zrevrangebyscore user:ranking 221 200 withscores
200以上的成员（无限大）
ZRANGEBYSCORE user:ranking 200 +inf withscores

返回指定分数内的成员数量
zcount user:ranking 100 200

删除指定排名内的成员
ZREMRANGEBYRANK user:ranking 0 1
类似
删除指定分数内的成员
zremrangebyscore user:ranking 250 +inf

集合间操作
交集
使用默认参数，集合成员做交集，分数相加
zinterstore user:ranking:1_inter_2 2 user:ranking:1 user:ranking:2
集合成员做交集，分数取交集成员的分数乘以权重后的较大值
zinterstore user:ranking:1_inter_2 2 user:ranking:1 user:ranking:2 weights 1 0.5 aggregate max

并集
类似交集，参数作用与交集一致
zunionstore user:ranking:1_union_2 2 user:ranking:1 user:ranking:2


使用场景：
排行榜系统


单键管理
删除指定键
del hello [key]

重命名键，可以对集合、hash等键重命名
rename zsetkey zsetky
rename user:1 user:info:1
当重命名的键不存在时，重命名才能成功，避免覆盖
renamenx zsetkey zsetky

返回当前库中的键值对数量
dbsize

随机返回一个键
randomkey

键过期
EXPIRE hello 10
查询键的剩余时间
ttl hello
毫秒级过期时间
pexpire key milliseconds
清除键的过期时间，即保留键
PERSIST key
以下命令相当于set+expire
setex name 50 vagrant
注意，字符串键在执行过set后，会移除过期时间

